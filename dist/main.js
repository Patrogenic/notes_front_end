(()=>{"use strict";const e="http://localhost:3000",t="http://localhost:3000",n="/dist/";let o={updateFolderData:async function(e,t,n,o,a){let i=await l.sendData(t,n,o,a);console.log(i),void 0!==i.name?d.updateFolder(e,i):console.log("edit was not successful")},deleteFolder:async function(e,t,n,o,a){let i=await l.sendData(t,n,o,a);console.log(i),0!==i.message.localeCompare("success")?console.log("error deleting folder"):d.deleteFolder(e)},updateNoteData:async function(e,t,n,o,a){let i=await l.sendData(t,n,o,a);console.log(i),void 0!==i.name?d.updateNote(i,e):console.log("error saving data")},deleteNote:async function(e,t,n,o,a){let i=await l.sendData(t,n,o,a);console.log(i),0!==i.message.localeCompare("success")?console.log("error deleting note"):d.deleteNote(e)},sendNewNoteData:async function(e,t,n,o,a){let i=await l.sendData(t,n,o,a);console.log(i),void 0!==i.name?d.addNote(i,e):console.log("error creating note")}},l=new class{constructor(){}getAllFolders(){const e=JSON.parse(localStorage.getItem("user")).token;return fetch("url",{method:"get",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Authorization:"Bearer "+e}}).then((e=>(console.log(e),e.json()))).then((e=>{console.log(e)}))}getData(e,t,n){const o=JSON.parse(localStorage.getItem("user")).token;return fetch(e,{method:t,headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Authorization:"Bearer "+o}}).then((e=>200!=e.status?e.status:e.json())).then((e=>n(e)))}sendData(e,t,n,o){const l=JSON.parse(localStorage.getItem("user")).token;return console.log("url: "+e),fetch(e,{method:t,headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Authorization:"Bearer "+l},body:JSON.stringify(n)}).then((e=>200!=e.status?e.status:e.json())).then((e=>o(e)))}},d=new class{constructor(){}toggleLoginTabs(){let e=document.getElementById("login-form"),t=document.getElementById("signup-form"),n=document.getElementById("login-tab"),o=document.getElementById("signup-tab");n.addEventListener("click",(()=>{e.style.display="block",t.style.display="none",n.style.backgroundColor="lightgrey",o.style.backgroundColor="transparent"})),o.addEventListener("click",(()=>{e.style.display="none",t.style.display="block",n.style.backgroundColor="transparent",o.style.backgroundColor="lightgrey"}))}toggleShowLogoutOption(){if(0===document.getElementById("logout").style.display.localeCompare("block"))document.getElementById("logout").style.display="none";else{let e=document.getElementById("user-icon").getBoundingClientRect();console.log(e),document.getElementById("logout").style.display="block",document.getElementById("logout").style.top=e.top+"px",document.getElementById("logout").style.left=e.left-110+"px"}}toggleShowFolderMenu(){let e=document.getElementById("folders-sidebar");0===e.style.visibility.localeCompare("visible")?e.style.visibility="hidden":e.style.visibility="visible"}displayAllFolderData(e,t){this.displayFolders(e,t)}displayFolders(e,t){console.log("http "+t);let n=document.getElementById("folders-container"),o=(document.getElementById("notes-container"),document.createElement("div"));for(let l=0;l<e.length;l++)o.innerHTML=e[l].name,o.id="folder"+l,o.classList.add("folder"),o.addEventListener("click",this.toggleCurrentFolder),n.appendChild(o),o=document.createElement("div"),this.buildNotesContainer(e[l],l,t)}addFolder(e,t){document.getElementById("new-folder-popup-wrapper").style.display="none";let n=document.getElementById("folders-container"),o=document.createElement("div"),l=n.childNodes.length+1;o.innerHTML=e.name,o.id="folder"+l,o.classList.add("folder"),o.addEventListener("click",this.toggleCurrentFolder),n.appendChild(o),this.buildNotesContainer(e,l,t)}deleteFolder(e){let t=document.getElementById("folder"+e.srcElement.id),n=document.getElementById("notes-sub-container"+e.srcElement.id);t.remove(),n.remove(),this.toggleCurrentFolder({srcElement:{id:"folder0"}})}updateFolder(e,t){document.getElementById("update-folder-popup-wrapper").style.display="none",document.getElementById("folder"+e).innerHTML=t.name,console.log(document.getElementById("folder"+e).innerHTML),document.getElementById("folder-name-notes-container"+e).innerHTML=t.name,document.getElementById("folder-description-notes-container"+e).innerHTML=t.description,document.getElementById("update-folder-name-field").value=t.name,document.getElementById("update-folder-description-field").value=t.description}addNote(e,t){document.getElementById("new-note-popup-wrapper").style.display="none";let n=document.getElementById("notes-sub-container"+t),o=document.createElement("div");o.innerHTML=e.name,n.appendChild(o)}updateNote(e,t){document.getElementById(t+"name").innerHTML=e.name,document.getElementById(t+"description").innerHTML=e.description,console.log("changes saved")}deleteNote(e){document.getElementById(e).remove(),document.getElementById("close-show-note-popup").click()}buildNotesContainer(e,t,n){let o=document.getElementById("notes-container"),l=document.createElement("div");l.classList.add("notes-sub-container"),l.id="notes-sub-container"+t;let d=document.createElement("div");d.id="folder-name-notes-container"+t,d.innerHTML=e.name;let a=document.createElement("div");if(a.id="folder-description-notes-container"+t,a.innerHTML=e.description,l.appendChild(d),l.appendChild(this.buildFolderDeleteBtn(e,t,n)),l.appendChild(this.buildFolderEditBtn(e,t,n)),l.appendChild(this.buildCreateNoteBtn(e,t,n)),l.appendChild(a),document.getElementById("close-show-note-popup").addEventListener("click",(()=>{document.getElementById("show-note-popup-wrapper").style.display="none",document.getElementById("edit-note-submit-btn").outerHTML=document.getElementById("edit-note-submit-btn").outerHTML,document.getElementById("delete-note-form").outerHTML=document.getElementById("delete-note-form").outerHTML})),null!=e.notes)for(let o=0;o<e.notes.length;o++)l.appendChild(this.buildNoteElement(e,t,n,o));o.appendChild(l)}buildFolderDeleteBtn(t,n,o){let l=document.createElement("button");return l.innerHTML="Delete",l.id=n,l.addEventListener("click",(n=>{o.deleteFolder(n,e+"/api/folder/"+t._id,"delete",{},(e=>e))})),l}buildFolderEditBtn(t,n,o){let l=document.createElement("button");return l.innerHTML="Edit",l.addEventListener("click",(()=>{document.getElementById("update-folder-name-field").value=document.getElementById("folder-name-notes-container"+n).innerHTML,document.getElementById("update-folder-description-field").value=document.getElementById("folder-description-notes-container"+n).innerHTML,document.getElementById("update-folder-popup-wrapper").style.display="block",document.getElementById("update-folder-form").addEventListener("submit",(l=>{l.preventDefault();let d=document.getElementById("update-folder-name-field").value,a=document.getElementById("update-folder-description-field").value;console.log(d),console.log(a),o.updateFolderData(n,e+"/api/folder/"+t._id,"put",{name:d,description:a},(e=>e)),document.getElementById("update-folder-form").outerHTML=document.getElementById("update-folder-form").outerHTML}))})),document.getElementById("close-update-folder-popup").addEventListener("click",(()=>{document.getElementById("update-folder-popup-wrapper").style.display="none"})),l}buildCreateNoteBtn(t,n,o){let l=document.createElement("button");return l.innerHTML="New Note",l.addEventListener("click",(()=>{document.getElementById("new-note-popup-wrapper").style.display="block",document.getElementById("new-note-form").addEventListener("submit",(l=>{l.preventDefault();let d=document.getElementById("new-note-name-field").value,a=document.getElementById("new-note-description-field").value;document.getElementById("new-note-name-field").value="",document.getElementById("new-note-description-field").value="",o.sendNewNoteData(n,e+"/api/folder/"+t._id+"/note","post",{name:d,description:a},(e=>e)),document.getElementById("update-folder-form").outerHTML=document.getElementById("update-folder-form").outerHTML}))})),document.getElementById("close-new-note-popup").addEventListener("click",(()=>{document.getElementById("new-note-popup-wrapper").style.display="none"})),l}buildNoteElement(t,n,o,l){let d=document.createElement("div"),a=document.createElement("div"),i=document.createElement("div");return d.id="folder"+n+"note"+l,d.classList.add("note"),a.innerHTML=t.notes[l].name,a.id="folder"+n+"note"+l+"name",a.classList.add("note-name"),i.innerHTML=t.notes[l].description,i.id="folder"+n+"note"+l+"description",i.classList.add("note-description"),d.addEventListener("click",(()=>{document.getElementById("show-note-popup-wrapper").style.display="block",document.getElementById("show-note-name-field").value=document.getElementById("folder"+n+"note"+l+"name").innerHTML,document.getElementById("show-note-description-field").value=document.getElementById("folder"+n+"note"+l+"description").innerHTML,document.getElementById("edit-note-submit-btn").addEventListener("click",(d=>{d.preventDefault(),console.log("called");let a=document.getElementById("show-note-name-field").value,i=document.getElementById("show-note-description-field").value;o.updateNoteData("folder"+n+"note"+l,e+"/api/folder/note/"+t.notes[l]._id,"put",{name:a,description:i},(e=>e))})),document.getElementById("delete-note-submit-btn").addEventListener("click",(d=>{d.preventDefault(),o.deleteNote("folder"+n+"note"+l,e+"/api/folder/note/"+t.notes[l]._id,"delete",{},(e=>e))}))})),d.appendChild(a),d.appendChild(i),d}toggleCurrentFolder(e){let t=document.getElementsByClassName("notes-sub-container");for(let e=0;e<t.length;e++)t[e].style.display="none";document.getElementById("notes-sub-container"+e.srcElement.id.substring(6)).style.display="block"}openNewFolderForm(){document.getElementById("new-folder-popup-wrapper").style.display="block"}closeNewFolderForm(){document.getElementById("new-folder-popup-wrapper").style.display="none"}};0===window.location.pathname.localeCompare(n+"login.html")?(d.toggleLoginTabs(),console.log("login page"),document.getElementById("login-form").addEventListener("submit",(e=>{e.preventDefault(),async function(e,t,n,o){let d=await l.sendData("http://localhost:3000/api/login","post",n,(e=>e));localStorage.setItem("user",JSON.stringify(d)),null!=d.token?window.location.href="dashboard.html":(document.getElementById("login-response").innerHTML="Invalid Credentials",console.log("invalid credentials"))}(0,0,{username:document.getElementById("username-field").value,password:document.getElementById("password-field").value})}))):0===window.location.pathname.localeCompare(n+"dashboard.html")&&(async function(){let e=await l.getData(t+"/api/folders","get",(e=>e));console.log(e),console.log(e.folderData),403===e?window.location.href="login.html":d.displayAllFolderData(e.folderData,o)}(),document.getElementById("open-new-folder-form").addEventListener("click",d.openNewFolderForm),document.getElementById("close-new-folder-popup").addEventListener("click",d.closeNewFolderForm),document.getElementById("logout").addEventListener("click",(function(){localStorage.setItem("user",JSON.stringify("")),window.location.href="login.html"})),document.getElementById("user-icon").addEventListener("click",d.toggleShowLogoutOption),document.getElementById("menu-icon").addEventListener("click",d.toggleShowFolderMenu),document.getElementById("new-folder-form").addEventListener("submit",(e=>{e.preventDefault();let t=document.getElementById("new-folder-name-field").value,n=document.getElementById("new-folder-description-field").value;document.getElementById("new-folder-name-field").value="",document.getElementById("new-folder-description-field").value="",async function(e,t,n,a){let i=await l.sendData("http://localhost:3000/api/folder","post",n,(e=>e));console.log(i),void 0!==i.name&&d.addFolder(i,o)}(0,0,{name:t,description:n})})))})();